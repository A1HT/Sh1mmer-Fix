<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SH1MMER</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/alpinejs/3.10.5/cdn.js"
        integrity="sha512-1fAkW3wqng/WNu86nQEgW3/RuPns2JxdC6WwCFJhqB/fL9VIWduIJmktYGrlBu99aoxwmWKCLY4AHlzDsh6LqA=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-MT82HHR67Y"></script>
    <script src="bg.js"></script>
    <link rel="stylesheet" href="base.css">
    <script>

    </script>
</head>

<body>
    <div id="background">
        <img id="backgroundimg" src="assets/background.png" />
    </div>
    <div id="app">
        <div class="t">
            When the block_devmode flag is set in FWMP, the system is stopped from booting while in devmode. However,
            the
            recovery screen is still accessible from within this state. Trying to recover using an image for a modified
            chrome os image will not work, as it gets stopped at the verification screen. RMA shim images are not fully
            verified in the same way and will boot even from this state.<br>
            Although this really isn't supposed to happen, signed images for the RMA shim repair tool can be found
            online.
            In order to use them with the block_devmode
            value set in VPD, credentials are needed for a recovery technician. The major flaw here is that only the
            kernel
            in partition 1 is signed, not the rootfs where the scripts are loaded from. Mounting the ROOT-A partition on
            the
            shim image is not possible due to they way the superblock is mangled on non developer images, but with the
            use
            of a hex editor the scripts can be carefully modified so long as the length of the replaced text matches the
            original text so to not corrupt the filesystem.<br><br>

            An example of such a replacement is here:
            <code>bbe -e 's/# Include after other common include\x2C side effect on GPT variable\x2E/echo "shimmering "\;sudo vpd -i RW_VPD -s check_enrollment=0\;reboot/g' /dev/sdX3 > /dev/sdX3</code><br><br>

            The “bbe” utility is used here to edit the stream directly, since sed is incapable of parsing binary
            files.<br>
            After the patch to the partition is made, the usb can be booted from and our arbitrary code will be
            executed, in
            this case deprovisioning the current device from the management organization entirely
        </div>
    </div>
</body>
<style>
    #app {
        /* padding: 5em; */
        overflow: hidden;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .t {
        width: 80%;
    }
</style>

</html>